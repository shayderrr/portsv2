try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},r=(new e.Error).stack;r&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[r]="35e29440-3d4e-4a72-b0de-d72e4d6e2887",e._sentryDebugIdIdentifier="sentry-dbid-35e29440-3d4e-4a72-b0de-d72e4d6e2887")}catch(e){}{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[new e.Error().stack]=Object.assign({},e._sentryModuleMetadata[new e.Error().stack],{"_sentryBundlerPluginAppKey:crazygames-portal":!0})}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[38963],{93260:(e,r,t)=>{t.d(r,{R:()=>l});var n=t(16522),s=t(96540),o=t(341),a=t(56800);let l=e=>{let r,t;let l=(0,n.c)(7),{game:u}=e,{setPlayingGame:i,setIsPlaying:c,resetGameInvites:d,setGameInviteLink:f}=s.useContext(a.Tz),p=s.useRef(!1);return l[0]!==u||l[1]!==d||l[2]!==f||l[3]!==c||l[4]!==i?(r=()=>{if(!u)return;i(u);let e=e=>{e.data&&e.data.type===o.x&&("gameLoaded"!==e.data.event||p.current||(p.current=!0,c(!0)))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e),i(null),c(!1),f(null),d(),p.current=!1}},t=[u,d,f,c,i],l[0]=u,l[1]=d,l[2]=f,l[3]=c,l[4]=i,l[5]=r,l[6]=t):(r=l[5],t=l[6]),s.useEffect(r,t),null}},56524:(e,r,t)=>{t.d(r,{u:()=>n,y:()=>s});let n="game-iframe";function s(){return document.getElementById(n)}},47413:(e,r,t)=>{t.d(r,{A:()=>l});var n=t(74848),s=t(16522),o=t(96540),a=t(85828);let l=function(e){return r=>{let t;let l=(0,s.c)(3),{services:u}=o.useContext(a.A);return l[0]!==r||l[1]!==u?(t=(0,n.jsx)(e,{services:u,...r}),l[0]=r,l[1]=u,l[2]=t):t=l[2],t}}},17277:(e,r,t)=>{t.d(r,{A:()=>m});var n=t(16522),s=t(96540),o=t(95420),a=t(18081),l=t(341),u=t(12896),i=t(29754),c=t(5752),d=t(68819),f=t(98640);async function p(e){let r=await fetch(e,{method:"GET"});return await r.text()}let m=e=>{let r,t,m,k,v,w;let g=(0,n.c)(23),{gameId:b,gameTechnology:F}=e,{user:E}=s.useContext(i.R),T=s.useContext(c.A),[x]=(0,o.n)(f.P),[C]=(0,o.n)(f.kL);g[0]===Symbol.for("react.memo_cache_sentinel")?(r={fetchPolicy:"network-only"},g[0]=r):r=g[0];let[L,R]=(0,a._)(f.IJ,r);g[1]===Symbol.for("react.memo_cache_sentinel")?(t=[],g[1]=t):t=g[1];let A=s.useRef(t);return g[2]!==R?(m=()=>{if(!R.called||R.loading)return;let e=R.data?.gameData;R.error?(A.current.forEach(h),A.current=[]):e&&e.dataUrl?p(e.dataUrl).then(r=>{let t={...e,data:r};A.current.forEach(e=>{e({type:"requestGameDataResponse",data:{store:t,error:R.error}})}),A.current=[]}):(A.current.forEach(e=>{e({type:"requestGameDataResponse",data:{store:void 0,error:R.error}})}),A.current=[])},k=[R],g[2]=R,g[3]=m,g[4]=k):(m=g[3],k=g[4]),s.useEffect(m,k),g[5]!==C||g[6]!==T.browser?.name||g[7]!==T.deviceType||g[8]!==b||g[9]!==F||g[10]!==L||g[11]!==x||g[12]!==E?(v=()=>{let e=e=>{E?(A.current=[r=>{let t=e.source;t&&t.postMessage(r,"*")},...A.current],L({variables:{id:b,technology:F}})):A.current.forEach(y)},r=e=>{let{store:r,version:t,updatedAtTz:n,playedTime:s}=e.data,o=JSON.stringify(r);x({variables:{input:{data:o,id:b,technology:F,version:t,browser:T.browser?.name||"",playedTime:s,deviceType:(0,d.mO)(T.deviceType),updatedAtTz:n}}})},t=e=>{let{version:r}=e.data;C({variables:{input:{id:b,technology:F,version:r,browser:T.browser?.name||"",deviceType:(0,d.mO)(T.deviceType)}}})},n=n=>{if(n.data&&n.data.type===l.x)switch(n.data.event){case"requestGameData":e(n);break;case"updateGameData":case"replaceGameData":(0,u.isDefined)(E)&&r(n);break;case"clearGameData":(0,u.isDefined)(E)&&t(n);break;default:return}};return window.addEventListener("message",n),function(){window.removeEventListener("message",n)}},g[5]=C,g[6]=T.browser?.name,g[7]=T.deviceType,g[8]=b,g[9]=F,g[10]=L,g[11]=x,g[12]=E,g[13]=v):v=g[13],g[14]!==C||g[15]!==T.browser||g[16]!==T.deviceType||g[17]!==b||g[18]!==F||g[19]!==L||g[20]!==x||g[21]!==E?(w=[x,L,C,b,F,E,T.browser,T.deviceType],g[14]=C,g[15]=T.browser,g[16]=T.deviceType,g[17]=b,g[18]=F,g[19]=L,g[20]=x,g[21]=E,g[22]=w):w=g[22],s.useEffect(v,w),null};function h(e){e({type:"requestGameDataNone"})}function y(e){e({type:"requestGameDataResponse",data:{store:void 0,error:null}})}},15579:(e,r,t)=>{t.d(r,{A:()=>c});var n=t(96540),s=t(341),o=t(72291),a=t(29754),l=t(82964),u=t(28390),i=t(55881);let c=e=>{let{gameId:r}=e,{user:t}=n.useContext(a.R),{openedDrawer:c}=n.useContext(i.l9),{drawerOpeningPending:d}=n.useContext(i.Cx),{openDrawer:f}=n.useContext(i.lv),{refetch:p,loading:m}=o.ic(),{refetch:h,loading:y}=o.X6(),[k,v]=(0,n.useState)(!1),[w,g]=(0,n.useState)(null),{user:b}=o.Jd();(0,n.useEffect)(()=>{if(!d&&k&&w&&(t||c||(v(!1),g(null),w.postMessage({type:"showAuthPromptResponse",error:{code:"userCancelled",message:"User cancelled the auth prompt"}},"*")),t&&b&&!c)){v(!1),g(null);let e={type:"showAuthPromptResponse",user:{id:b.id,username:`${b.username}`,profilePictureUrl:`${l.A.Instance.data.images}${b.profile.avatar}`}};w.postMessage(e,"*")}},[c,k,t,w,b,d]);let F=(0,n.useCallback)(async(e,n)=>{let s;if(!t){s={type:"requestUserTokenResponse",error:{code:"userNotAuthenticated",message:"The user is not authenticated"}},e.postMessage(s,"*");return}if(m)return;let o=await p({gameId:r,iframeUrl:n}),a=o.data?.userToken;o.error||!a?(console.error("User token retrieve error",o.error),s={type:"requestUserTokenResponse",error:{code:"unexpectedError",message:"Failed to retrieve user token"}}):s={type:"requestUserTokenResponse",token:a.token,expiresIn:a.expiresIn},e.postMessage(s,"*")},[t,m,p,r]),E=(0,n.useCallback)(async e=>{let n;if(!e){console.error("GFWindow not found");return}if(!t){n={type:"requestXsollaUserTokenResponse",error:{code:"userNotAuthenticated",message:"The user is not authenticated"}},e.postMessage(n,"*");return}if(y)return;let s=await h({gameId:r}),o=s.data?.xsollaUserToken;if(s.error||!o){let e,r;console.error("Xsolla user token retrieve error",s.error),(e=>"object"==typeof e&&null!==e&&"graphQLErrors"in e&&Array.isArray(e.graphQLErrors))(s.error)&&s.error.graphQLErrors.length>0&&(e=s.error.graphQLErrors[0]?.extensions?.code,r=s.error.graphQLErrors[0]?.message),n=e?{type:"requestXsollaUserTokenResponse",error:{code:e,message:r||""}}:{type:"requestXsollaUserTokenResponse",error:{code:"unexpectedError",message:"Failed to retrieve Xsolla user token"}}}else n={type:"requestXsollaUserTokenResponse",token:o.token,expiresIn:o.expiresIn};e.postMessage(n,"*")},[r,h,t,y]);return(0,n.useEffect)(()=>{let e=e=>{let r=()=>{setTimeout(()=>{f("signIn"),v(!0),g(e.source),u.A.removeFakeFullscreenListener(r)},100)};u.A.isFakeFullscreen()?u.A.addFakeFullscreenListener(r):(f("signIn"),v(!0),g(e.source))},r=r=>{if(r.data&&r.data.type===s.x)switch(r.data.event){case"requestUserToken":{let e=r.data;F(r.source,e.iframeUrl);break}case"requestXsollaUserToken":E(r.source);break;case"showAuthPrompt":e(r);break;default:return}};return window.addEventListener("message",r),function(){window.removeEventListener("message",r)}},[r,t,f,E,F]),null}},64821:(e,r,t)=>{t.d(r,{A:()=>l});var n=t(74848),s=t(16522),o=t(96540),a=t(52020);let l=function(e){return r=>{let t;let l=(0,s.c)(3),u=o.useContext(a.H);return l[0]!==u||l[1]!==r?(t=(0,n.jsx)(e,{experiment:u,...r}),l[0]=u,l[1]=r,l[2]=t):t=l[2],t}}},28390:(e,r,t)=>{t.d(r,{A:()=>s});class n{removeFullscreenListener(e){this.eventKeys.forEach(r=>{document.removeEventListener(r,e)})}addFullscreenListener(e){this.eventKeys.forEach(r=>{document.addEventListener(r,e)})}addFakeFullscreenListener(e){this.fakeFullscreenListeners.push(e)}removeFakeFullscreenListener(e){this.fakeFullscreenListeners=this.fakeFullscreenListeners.filter(r=>r!==e)}isFullscreen(){let e=window.document;return!!(e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement)}isFakeFullscreen(){return this.isInFakeFullscreen}enteredFakeFullscreen(){this.isInFakeFullscreen||(this.isInFakeFullscreen=!0,this.fakeFullscreenListeners.forEach(e=>e()))}exitFakeFullscreen(){this.isInFakeFullscreen&&(this.isInFakeFullscreen=!1,this.fakeFullscreenListeners.forEach(e=>e()))}exitNativeFullscreen(){let e=window.document,r=e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen;return!!r&&(window.document.fullscreenElement&&r.call(e),!0)}constructor(){this.fakeFullscreenListeners=[],this.eventKeys=["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],this.isInFakeFullscreen=!1,this.forceLockOrientation=async(e,r)=>{if(!r||"BOTH"===r||!("screen"in window)||!window.screen||!window.screen.orientation||!window.screen.orientation.lock)return;let t=null;try{await Promise.race([window.screen.orientation.lock("PORTRAIT"===r?"portrait":"landscape"),new Promise((r,n)=>{t=setTimeout(()=>{e.trackGenericError("timeoutError",{message:"Error in orientation lock timeout"}),n(Error("Orientation lock timeout"))},1e3)})])}catch(e){}finally{t&&clearTimeout(t)}}}}let s=new n},18081:(e,r,t)=>{t.d(r,{_:()=>d});var n,s=t(31635),o=t(27243),a=t(60144),l=t(68195),u=t(54269);function i(){}t(67235);var c=["refetch","reobserve","fetchMore","updateQuery","startPolling","stopPolling","subscribeToMore"];function d(e,r){var t,d=o.useRef(void 0),f=o.useRef(void 0),p=o.useRef(void 0),m=(0,a.l)(r,d.current||{}),h=null!==(t=null==m?void 0:m.query)&&void 0!==t?t:e;f.current=r,p.current=h;var y=(0,s.Cl)((0,s.Cl)({},m),{skip:!d.current}),k=(0,l.SX)(h,y),v=k.obsQueryFields,w=k.result,g=k.client,b=k.resultData,F=k.observable,E=k.onQueryExecuted,T=F.options.initialFetchPolicy||(0,l.kk)(y.defaultOptions,g.defaultOptions),x=o.useReducer(function(e){return e+1},0)[1],C=o.useMemo(function(){for(var e={},r=0;r<c.length;r++)!function(r){var t=v[r];e[r]=function(){return d.current||(d.current=Object.create(null),x()),t.apply(this,arguments)}}(c[r]);return e},[x,v]),L=!!d.current,R=o.useMemo(function(){return(0,s.Cl)((0,s.Cl)((0,s.Cl)({},w),C),{called:L})},[w,C,L]),A=(n||(n=o.createContext(null)),o.useCallback(function(){var e=console.error;try{return console.error=i,o.useContext(n),!0}catch(e){return!1}finally{console.error=e}},[]));o.useRef(new Set);var I=o.useCallback(function(e){d.current=e?(0,s.Cl)((0,s.Cl)({},e),{fetchPolicy:e.fetchPolicy||T}):{fetchPolicy:T};var r,t,n,o,u=(0,a.l)(f.current,(0,s.Cl)({query:p.current},d.current)),i=(t=(r=(0,s.Cl)((0,s.Cl)({},u),{skip:!1})).query||h,n=(0,l.Er)(g,t,r,!1)(F),o=F.reobserveAsConcast((0,l.t_)(F,g,r,n)),E(n),new Promise(function(e){var r;o.subscribe({next:function(e){r=e},error:function(){e((0,l.$X)(F.getCurrentResult(),b.previousData,F,g))},complete:function(){e((0,l.$X)(F.maskResult(r),b.previousData,F,g))}})})).then(function(e){return Object.assign(e,C)});return i.catch(function(){}),i},[A,g,h,C,T,F,b,E]),M=o.useRef(I);return(0,u.E)(function(){M.current=I}),[o.useCallback(function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return M.current.apply(M,e)},[]),R]}}}]);