<?xml version="1.0" encoding="UTF-8" ?>
<Module>
<Content type="html"><![CDATA[

<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <style>
    html,
    body {
      background-image: url('https://cdn.jsdelivr.net/gh/netclassroom/5567799@main/TemplateData/bg.png');;
      background-position: center;
        background-repeat: no-repeat;
        background-size: cover;
      width: 100%;
      height: 100%;
      overflow: visible;
      padding: 0;
      margin: 0;
    }
    div#gameContainer {
      background: transparent !important;
      position: absolute;
    }
    div#gameContainer canvas {
      position: absolute;
    }
    div#gameContainer canvas[data-pixel-art="true"] {
      position: absolute;
      image-rendering: optimizeSpeed;
      image-rendering: -webkit-crisp-edges;
      image-rendering: -moz-crisp-edges;
      image-rendering: -o-crisp-edges;
      image-rendering: crisp-edges;
      image-rendering: -webkit-optimize-contrast;
      image-rendering: optimize-contrast;
      image-rendering: pixelated;
      -ms-interpolation-mode: nearest-neighbor;
    }
    .loadingOut{ 
        width:250px; 
        position:fixed; 
        left:50%; 
        top:calc(50% - 8px);
        transform:translate(-50%);
         border: 2px solid white;
        height: 14px;
    }
    .centered {
     position: fixed;
    top: 50%;
    left: 50%;
    margin-top: -150px;
    margin-left: -250px;
    width: 500px;
    }
  </style>
</head>
<body>
  <div id="gameContainer">
    <img src="https://cdn.jsdelivr.net/gh/netclassroom/5567799@main/TemplateData/logo.png" class="centered" >
    <div class="loadingOut"> </div>
    <canvas id="unity-canvas" data-pixel-art=""></canvas>
    <script src="https://cdn.jsdelivr.net/gh/netclassroom/5567799@main/Build/TPG_DashParty_V05.loader.js"></script>
    <script>
      var canvas = document.querySelector("#unity-canvas");
      
      // Data dosyası parçaları (6 part: 0-5)
      var dataParts = [
        "https://cdn.jsdelivr.net/gh/netclassroom/5567799@main/Build/TPG_DashParty_V05.data.unityweb.part0",
        "https://cdn.jsdelivr.net/gh/netclassroom/5567799@main/Build/TPG_DashParty_V05.data.unityweb.part1",
        "https://cdn.jsdelivr.net/gh/netclassroom/5567799@main/Build/TPG_DashParty_V05.data.unityweb.part2",
        "https://cdn.jsdelivr.net/gh/netclassroom/5567799@main/Build/TPG_DashParty_V05.data.unityweb.part3",
        "https://cdn.jsdelivr.net/gh/netclassroom/5567799@main/Build/TPG_DashParty_V05.data.unityweb.part4",
        "https://cdn.jsdelivr.net/gh/netclassroom/5567799@main/Build/TPG_DashParty_V05.data.unityweb.part5"
      ];
      
      var scaleToFit;
      try {
        scaleToFit = !!JSON.parse("");
      } catch (e) {
        scaleToFit = true;
      }
      
      function progressHandler(progress) {
        var percent = progress * 100 + '%';
        canvas.style.background = 'linear-gradient(to right, white, white ' + percent + ', transparent ' + percent + ', transparent) no-repeat center';
        canvas.style.backgroundSize = '100% 1rem';
        canvas.style.width='250px'; 
        canvas.style.position='fixed'; 
        canvas.style.left='50%'; 
        canvas.style.transform='translate(-50%)'; 
      }
      
      function onResize() {
        var container = canvas.parentElement;
        var w;
        var h;
        if (scaleToFit) {
          w = window.innerWidth;
          h = window.innerHeight;
          var r = 1080 / 1920;
          if (w * r > window.innerHeight) {
            w = Math.min(w, Math.ceil(h / r));
          }
          h = Math.floor(w * r);
        } else {
          w = 1920;
          h = 1080;
        }
        container.style.width = canvas.style.width = w + "px";
        container.style.height = canvas.style.height = h + "px";
        container.style.top = Math.floor((window.innerHeight - h) / 2) + "px";
        container.style.left = Math.floor((window.innerWidth - w) / 2) + "px";
      }
      
      // Parçaları birleştir ve Blob URL oluştur
      async function mergeDataParts(parts) {
        var chunks = [];
        var loadedParts = 0;
        var totalParts = parts.length;
        
        for (var i = 0; i < parts.length; i++) {
          var response = await fetch(parts[i]);
          var arrayBuffer = await response.arrayBuffer();
          chunks.push(arrayBuffer);
          loadedParts++;
          // Birleştirme progress (toplam progress'in %50'si)
          progressHandler(loadedParts / totalParts * 0.5);
        }
        
        var totalLength = chunks.reduce(function(acc, chunk) { return acc + chunk.byteLength; }, 0);
        var combined = new Uint8Array(totalLength);
        var offset = 0;
        
        for (var j = 0; j < chunks.length; j++) {
          combined.set(new Uint8Array(chunks[j]), offset);
          offset += chunks[j].byteLength;
        }
        
        var blob = new Blob([combined], { type: "application/octet-stream" });
        return URL.createObjectURL(blob);
      }
      
      // Ana başlatma fonksiyonu
      async function startGame() {
        // Data parçalarını birleştir
        var mergedDataUrl = await mergeDataParts(dataParts);
        
        var config = {
          dataUrl: mergedDataUrl,
          frameworkUrl: "https://cdn.jsdelivr.net/gh/netclassroom/5567799@main/Build/TPG_DashParty_V05.framework.js.unityweb",
          codeUrl: "https://cdn.jsdelivr.net/gh/netclassroom/5567799@main/Build/TPG_DashParty_V05.wasm.unityweb",
          streamingAssetsUrl: "StreamingAssets",
          companyName: "RHM Interactive",
          productName: "Dash Party",
          productVersion: "1.3.6",
        };
        
        createUnityInstance(canvas, config, function(progress) {
          // Unity yükleme progress (toplam progress'in %50'si + önceki %50)
          progressHandler(0.5 + progress * 0.5);
        }).then(function (instance) {
          canvas = instance.Module.canvas;
          onResize();
          // Blob URL'i temizle
          URL.revokeObjectURL(mergedDataUrl);
        });
      }
      
      window.addEventListener('resize', onResize);
      onResize();
      
      // Oyunu başlat
      startGame();
    </script>
  </div>
  
  <!-- gooooooooooooooooooooooooooooooooooooooooooooooo -->
<style>
  /* Full screen dark overlay */
  #ad-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.60);
    display: none;
    z-index: 99998;
    transition: opacity 0.4s ease-out;
  }

  #ad-overlay.fade-out {
    opacity: 0;
  }

  /* Container: Center of screen, fixed */
  #ad-container {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 370px;
    height: 310px;
    background: rgba(0, 0, 0, 0.90);
    display: none;
    z-index: 99999;
    border-radius: 0;
    overflow: hidden;
    box-shadow: 0 4px 30px rgba(0, 0, 0, 0.8);
    box-sizing: border-box;
    transition: opacity 0.4s ease-out, transform 0.4s ease-out;
  }

  #ad-container.fade-out {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.95);
  }

  #ad-iframe {
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 370px;
    height: 330px;
    border: 0;
    display: block;
    overflow: hidden;
    pointer-events: auto;
    box-sizing: content-box;
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  
  #ad-iframe::-webkit-scrollbar {
    display: none;
    width: 0;
    height: 0;
  }

  /* Base button styles */
  .ad-close-btn {
    position: absolute;
    background: #ff4d4d;
    color: #fff;
    border: none;
    padding: 6px 10px;
    font-size: 14px;
    font-weight: bold;
    border-radius: 4px;
    z-index: 100000;
  }

  /* Fake close button - clickthrough */
  #fake-close {
    cursor: pointer;
    pointer-events: none; /* Click passes through */
    opacity: 0.85;
  }

  /* Real close button - hidden initially */
  #real-close {
    cursor: pointer;
    z-index: 100001;
    display: none;
    opacity: 0;
    transition: opacity 0.3s ease-in;
  }

  #real-close.visible {
    display: block;
    opacity: 1;
  }

  #real-close:hover {
    background: #ff3333;
  }

  /* Corner positions */
  .corner-top-left {
    top: 6px;
    left: 8px;
  }
  .corner-top-right {
    top: 6px;
    right: 8px;
  }
  .corner-bottom-left {
    bottom: 6px;
    left: 8px;
  }
  .corner-bottom-right {
    bottom: 6px;
    right: 8px;
  }

  /* Right mask for scrollbar */
  #ad-right-mask {
    position: absolute;
    top: 0;
    right: 0;
    width: 12px;
    height: 100%;
    pointer-events: none;
    background: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.9));
    z-index: 99999;
  }

  /* Mobile adjustments */
  @media (max-width: 440px) {
    #ad-container {
      width: calc(100% - 20px);
      max-width: 360px;
    }
    #ad-iframe {
      width: 100%;
      max-width: 360px;
    }
  }
</style>

<!-- Full screen overlay -->
<div id="ad-overlay"></div>

<!-- Ad container -->
<div id="ad-container" aria-hidden="true" role="dialog" aria-label="Advertisement">
  <iframe
    id="ad-iframe"
    src="https://script.google.com/macros/s/AKfycbyLuArnqQWhE6SmUPiOLVCib2W7b_xMQPKMd20jB7ySrD1so4x7WIv_vwWh3LLG4Npw/exec"
    width="360px"
    height="310px"
    scrolling="no"
    frameborder="0"
    sandbox="allow-scripts allow-popups allow-same-origin"
  ></iframe>
  <button id="fake-close" class="ad-close-btn">✕</button>
  <button id="real-close" class="ad-close-btn">Close Ad</button>
  <div id="ad-right-mask"></div>
</div>

<script>
  (function () {
    const showDelay = 3000; // 3 seconds delay before first show
    const realCloseDelay = 3000; // 3 seconds before real close appears
    const reappearDelay = 120000; // 60 seconds before reappearance
    
    const adOverlay = document.getElementById('ad-overlay');
    const adContainer = document.getElementById('ad-container');
    const fakeClose = document.getElementById('fake-close');
    const realClose = document.getElementById('real-close');

    // Corner class names
    const corners = [
      'corner-top-left',
      'corner-top-right',
      'corner-bottom-left',
      'corner-bottom-right'
    ];

    // Remove all corner classes from element
    function clearCorners(element) {
      corners.forEach(corner => element.classList.remove(corner));
    }

    // Get random corner
    function getRandomCorner() {
      return corners[Math.floor(Math.random() * corners.length)];
    }

    // Set button to random corner
    function setRandomCorner(button) {
      clearCorners(button);
      button.classList.add(getRandomCorner());
    }

    function showAd() {
      // Reset states
      adOverlay.classList.remove('fade-out');
      adContainer.classList.remove('fade-out');
      fakeClose.style.display = 'block';
      realClose.classList.remove('visible');
      realClose.style.display = 'none';

      // Set fake button to random corner
      setRandomCorner(fakeClose);

      // Show overlay and container
      adOverlay.style.display = 'block';
      adContainer.style.display = 'block';
      adContainer.setAttribute('aria-hidden', 'false');

      // After 3 seconds, show real close button and hide fake
      setTimeout(() => {
        fakeClose.style.display = 'none';
        
        // Set real button to random corner (can be different from fake)
        setRandomCorner(realClose);
        
        realClose.style.display = 'block';
        // Force reflow for animation
        realClose.offsetHeight;
        realClose.classList.add('visible');
      }, realCloseDelay);
    }

    function closeAd() {
      // Fade out animation
      adOverlay.classList.add('fade-out');
      adContainer.classList.add('fade-out');

      // After animation, hide completely
      setTimeout(() => {
        adOverlay.style.display = 'none';
        adContainer.style.display = 'none';
        adContainer.setAttribute('aria-hidden', 'true');
        
        // Focus back to game (will be customized later)
        if (typeof window.focusGame === 'function') {
          window.focusGame();
        }
      }, 400);

      // Schedule reappearance
      setTimeout(showAd, reappearDelay);
    }

    // Initial ad show
    setTimeout(showAd, showDelay);

    // Real close button click
    realClose.addEventListener('click', closeAd);

    // Expose functions globally for game integration
    window.showInterstitialAd = showAd;
    window.closeInterstitialAd = closeAd;
  })();
</script>


</body>
</html>


]]></Content>
</Module>